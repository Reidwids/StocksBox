<div id="profileGrid">
    <input type="hidden" value='<%= chartData %>' id="chartData">
    <div id="profileHeader">header
    </div>
    <div id="profileInfo">
        <label id="profileLabel"><%= user.firstName%> <%= user.lastName%></label>
        <div id="picWithBio">
            <img src="<%= user.image %>" id="profilePic">
            <div id="userBio"><%= user.bio %></div>
        </div>
    </div> 
    <div id="profileFeed">feed</div>
    <div id="overallProgress">
        <div id="progressChartCont">
            <canvas id="progressChart"></canvas>
        </div>
    </div>
    <div id="topPortfolios">
        <label class="profileLabel ">Portfolios</label>
        <div id="portfolioList">
            <% user.portfolios.forEach((portfolio)=>{ %>
                <div class="portfolioListEl">
                    <label id="portfolioName"><%= portfolio.portfolioName %></label>
                    <div id="portfolioTopAssets"><% portfolio.assets.forEach((asset)=>{ %>
                        <div class="portfolioAsset"><%= asset.assetName %>: $<%= Math.round((asset.assetGain)*100)/100 %></div>
                    <% }) %> 
                    </div>
                    <div id="portfolioTotalGains">Gains: <% if (portfolio.gainsHist[portfolio.gainsHist.length-1]>0) {%>
                        <span id='arrow'>↑</span><% }else{ %><span id='arrow'>↓</span><% } %>$<%= Math.round((portfolio.gainsHist[portfolio.gainsHist.length-1])*100)/100 %> %: <%=  %></div>
                </div>
            <% }) %>
            </div>
        </div>
<script>
    
    // let user = JSON.parse(document.getElementById('userForScript').value);
    let chartData = JSON.parse(document.getElementById('chartData').value).data;
    let chartDates = [];
    let chartVals = [];
    chartData.forEach(x=>{
        chartDates.push(x[0]);
        chartVals.push(x[1]);
    })
    let myChart = document.getElementById('progressChart').getContext('2d');
    let lineChart = new Chart(myChart, {
        type:'line',
        data:{
            labels: chartDates,
            datasets:[{
                data: chartVals,
                // borderColor:rgb(200, 150, 90)
            }],
        },
        options:{
            plugins: {
                legend: {
                    display: false
                }
            },
            maintainAspectRatio: false,
            responsive: true,
        }
    });
</script>